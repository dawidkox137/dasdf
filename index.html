<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ładowanie treści — proszę czekać</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #0f1115;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 500px;
      width: 100%;
      text-align: center;
    }
    h1 {
      font-size: 20px;
      margin-bottom: 10px;
    }
    p {
      font-size: 14px;
      color: #bbb;
      margin-bottom: 20px;
    }
    .progress-bar {
      width: 100%;
      height: 20px;
      background: #222;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 15px;
    }
    .progress {
      height: 100%;
      background: linear-gradient(to right, #ffcc00, #ffaa00);
      width: 0%;
      transition: width 0.25s linear;
    }
    .ads-log {
      background: #1a1c20;
      padding: 10px;
      font-size: 12px;
      max-height: 120px;
      overflow-y: auto;
      border-radius: 6px;
      text-align: left;
    }
    button {
      margin-top: 20px;
      padding: 10px 16px;
      background: #ffaa00;
      color: #000;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    button:disabled {
      background: #555;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Trwa przygotowywanie pliku</h1>
    <p>Proszę czekać. Weryfikujemy dostępność i przygotowujemy plik do pobrania.</p>
    <div class="progress-bar">
      <div class="progress" id="progress"></div>
    </div>
    <div class="ads-log" id="adsLog">Reklamy:</div>
    <button id="redirectBtn" disabled>Przekieruj do pliku</button>
  </div>

  <script>
    const initialLoadTime = 30; // Fałszywe 10s, naprawdę 30s
    const extraLoadTime = 30; // Dodatkowe 30s po kliknięciu
    const adInterval = 4; // co 4 sekundy
    const preRedirectAds = 4;
    const redirectUrl = "https://limewire.com/d/Uwc3k#fBGsTokD52";

    const redirectBtn = document.getElementById("redirectBtn");
    const progressBar = document.getElementById("progress");
    const adsLog = document.getElementById("adsLog");

    const sampleAds = [
      "https://www.youtube.com/watch?v=ds6AqaOK-gQ",
      "https://www.youtube.com/watch?v=_kV87STn6FM",
      "https://www.youtube.com/watch?v=4Cw113pFkJo",
      "https://www.youtube.com/watch?v=062AaADlqZo",
      "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
    ];

    let secondsPassed = 0;
    let adTimer;
    let loadTimer;
    let inExtraLoading = false;
    let extraSeconds = 0;
    let redirectAdCount = 0;

    function showAd(log = "Reklama") {
      const adUrl = sampleAds[Math.floor(Math.random() * sampleAds.length)];
      window.open(adUrl, "_blank");
      adsLog.innerHTML += `${log}: otwarto reklamę<br>`;
    }

    function updateProgressBar(percent) {
      progressBar.style.width = percent + "%";
    }

    function startInitialLoading() {
      adTimer = setInterval(() => {
        if (!inExtraLoading) showAd("Reklama");
      }, adInterval * 1000);

      loadTimer = setInterval(() => {
        secondsPassed++;
        const percent = Math.min((secondsPassed / initialLoadTime) * 100, 100);
        updateProgressBar(percent);

        if (secondsPassed >= initialLoadTime) {
          clearInterval(loadTimer);
          redirectBtn.disabled = false;
          adsLog.innerHTML += "Gotowe do przekierowania.<br>";
        }
      }, 1000);
    }

    function startExtraLoading() {
      inExtraLoading = true;
      redirectBtn.textContent = "Trwa końcowe weryfikowanie...";
      adsLog.innerHTML += "Uruchomiono końcowe ładowanie...<br>";

      let interval = setInterval(() => {
        extraSeconds++;

        // Otwieranie dodatkowych reklam co 4s
        if (extraSeconds % 4 === 0) {
          showAd("Reklama końcowa");
        }

        const percent = Math.min((extraSeconds / extraLoadTime) * 100, 100);
        updateProgressBar(percent);

        if (extraSeconds >= extraLoadTime) {
          clearInterval(interval);
          redirectBtn.textContent = "Trwa przekierowywanie...";
          adsLog.innerHTML += "Przekierowanie...<br>";

          // Jeszcze jedna runda reklam
          const spamInterval = setInterval(() => {
            if (redirectAdCount < preRedirectAds) {
              showAd("Reklama przed końcem");
              redirectAdCount++;
            } else {
              clearInterval(spamInterval);
              window.location.href = redirectUrl;
            }
          }, 1500);
        }
      }, 1000);
    }

    redirectBtn.addEventListener("click", () => {
      redirectBtn.disabled = true;
      startExtraLoading();
    });

    window.onload = () => {
      startInitialLoading();
    };
  </script>
</body>
</html>
